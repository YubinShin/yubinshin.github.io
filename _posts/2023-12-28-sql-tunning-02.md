---
title: SQL íŠœë‹ - 2 ì¿¼ë¦¬ ìµœì í™”
date: 2023-12-28
categories: [blog, backend]
tags: [database, index, sql, mysql, postgresql, improvement, tunning]
---

## ğŸ¬ **ìµœì í™”í•  ì¿¼ë¦¬ë¬¸ ì°¾ê¸°**
### **Explain ì´ë€?**

**`EXPLAIN`** êµ¬ë¬¸ì€ MySQLì´ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ëŠ” ë°©ì‹ì„ ì œê³µí•˜ëŠ” ëª…ë ¹ë¬¸ì…ë‹ˆë‹¤. 

ìš°ë¦¬ëŠ” ì´ êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ì—¬ ìµœì í™”í•  ì¿¼ë¦¬ë¬¸ì„ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì´ êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ë©´ MySQL ì˜µí‹°ë§ˆì´ì €ê°€ **í…Œì´ë¸”ì— ì•¡ì„¸ìŠ¤**í•˜ê³  **ì¿¼ë¦¬ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•**ì— ëŒ€í•œ ì •ë³´ë¥¼ ë³´ì—¬ì£¼ëŠ”ë°, ì´ë¥¼ **ì¿¼ë¦¬ ì‹¤í–‰ ê³„íš**ì´ë¼ê³  í•©ë‹ˆë‹¤.

### **Explain ì‚¬ìš©í•´ë³´ê¸°**

ì´ë ‡ê²Œ `SELECT` ì•ì— `EXPLIAN` ì„ ì ì–´ì£¼ë©´, MySQLì´ í…Œì´ë¸”ì— ì•¡ì„¸ìŠ¤í•œ ë°©ë²•ì„ ë³´ì—¬ì£¼ëŠ” ì¶œë ¥(ì‹¤í–‰ ê³„íš)ì„ ë°˜í™˜í•©ë‹ˆë‹¤. 

```sql
EXPLAIN SELECT * FROM people;
```

ë°˜í™˜ê°’ì˜ ì—´ì„ í•˜ë‚˜í•˜ë‚˜ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

> - ID: ì‹¤í–‰ ì¤‘ì¸ ì¿¼ë¦¬ì˜ ê³ ìœ  ì‹ë³„ìì…ë‹ˆë‹¤.
> - Select Type: ì‹¤í–‰ë˜ëŠ” select ë¬¸ì˜ ìœ í˜•ì„ ì•Œë ¤ì¤ë‹ˆë‹¤. (ì˜ˆ - simple, primary, union ë“±)
> - Table: ì ‘ê·¼ë˜ëŠ” í…Œì´ë¸”ì˜ ì´ë¦„ì…ë‹ˆë‹¤.
> - Partitions: ì¿¼ë¦¬ì— ëŒ€í•´ ì ‘ê·¼ë˜ëŠ” íŒŒí‹°ì…˜ì„ í‘œì‹œí•©ë‹ˆë‹¤(ì´ ê³¼ì •ì—ì„œëŠ” ë²”ìœ„ë¥¼ ë„˜ì–´ì„­ë‹ˆë‹¤).
> - <span style="color:red;font-weight : bold;">Type</span>: MySQLì´ ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ëŠ” ë° ì‚¬ìš©í•œ ì ‘ê·¼ ë°©ì‹ì…ë‹ˆë‹¤. ì´ê²ƒì€ ê°€ì¥ ì¤‘ìš”í•œ ì—´ ê°’ ì¤‘ í•˜ë‚˜ì´ë©°, ë‚˜ì¤‘ì— ìì„¸íˆ ë…¼ì˜í•˜ê² ìŠµë‹ˆë‹¤.
> - Possible Keys: MySQLì´ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” index ë“¤ì…ë‹ˆë‹¤.
> - Key: MySQLì´ ì‹¤ì œë¡œ ì‚¬ìš©í•˜ëŠ” index ì…ë‹ˆë‹¤.
> - Key Length: MySQLì´ ì‚¬ìš©í•˜ëŠ” index ì˜ ê¸¸ì´ë¥¼ í‘œì‹œí•©ë‹ˆë‹¤.
> - Ref: indexì™€ ë¹„êµë˜ëŠ” ê°’ì…ë‹ˆë‹¤.
> - Rows:  MySQLì´ ê²°ê³¼ë¥¼ ë°˜í™˜í•˜ê¸° ìœ„í•´ í™•ì¸í•´ì•¼ í•  ì¶”ì • í–‰ ìˆ˜ì…ë‹ˆë‹¤.
> - Filtered: ì¿¼ë¦¬ ê¸°ì¤€ì— ë¶€í•©í•˜ëŠ” ì¶”ì • í–‰ì˜ ë¹„ìœ¨ì…ë‹ˆë‹¤.

### **Explain ì˜ TYPE ì¹¼ëŸ¼ ì´í•´í•˜ê¸°**

`EXPLAIN` êµ¬ë¬¸ì„ ì‚¬ìš©í•˜ë©´ ìš°ë¦¬ëŠ” **ì¿¼ë¦¬ ì‹¤í–‰ ê³„íš**ì´ë¼ëŠ” ê°’ì„ ë°˜í™˜ë°›ìŠµë‹ˆë‹¤.

ì´ ê¸€ì—ì„œëŠ” ë°˜í™˜ê°’ì—ì„œ ê°€ì¥ ì¤‘ìš”í•œ ì—´ ì¤‘ í•˜ë‚˜ì¸ **type**ì— ëŒ€í•´ ìì„¸íˆ ì•Œì•„ë³´ê² ìŠµë‹ˆë‹¤.

> constë‚˜ ref ì ‘ê·¼ ë°©ì‹ì„ ë³¸ë‹¤ë©´, ì˜ êµ¬ì¡°í™”ëœ ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë©° ì„±ëŠ¥ì´ ì¢‹ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
> 
> index, all ì ‘ê·¼ ë°©ì‹ì„ ë³¸ë‹¤ë©´, ë¹ ë¥´ê²Œ ìµœì í™”ë¥¼ ì‹œì‘í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

#### **Const**

ì‹œê°„ë³µì¡ë„ : O(1)

const ì ‘ê·¼ ë°©ì‹ì€ ê°€ì¥ íš¨ìœ¨ì ì¸ ë°©ë²• ì¤‘ í•˜ë‚˜ì…ë‹ˆë‹¤. 

const ì ‘ê·¼ì€ ê¸°ë³¸ í‚¤(Primary Key)ë‚˜ ê³ ìœ  ì¸ë±ìŠ¤(Unique Index)ê°€ ìˆì„ ë•Œë§Œ ì‚¬ìš©ë˜ë©°, MySQLì´ **í•œë²ˆì˜ ì‘ì—…** ë§Œìœ¼ë¡œ í•„ìš”í•œ í–‰ì„ ì°¾ì„ ìˆ˜ ìˆê²Œ í•©ë‹ˆë‹¤. 

type ì—´ì—ì„œ constë¥¼ ë³¼ ë•Œ, MySQLì€ ì´ ì¿¼ë¦¬ì— ëŒ€í•´ ë‹¨ í•˜ë‚˜ì˜ ì¼ì¹˜ í•­ëª©ë§Œ ìˆë‹¤ëŠ” ê²ƒì„ ì•Œê³  ìˆìœ¼ë©°, ì´ëŠ” ì‘ì—…ì´ ê°€ì¥ íš¨ìœ¨ì ì´ë¼ëŠ” ëœ»ì…ë‹ˆë‹¤.

#### **Ref**

ì‹œê°„ë³µì¡ë„ : O(log N)

ref ì ‘ê·¼ ë°©ì‹ì€ constë³´ë‹¤ëŠ” ì•½ê°„ ëœ íš¨ìœ¨ì ì´ì§€ë§Œ, ì ì ˆí•œ ì¸ë±ìŠ¤ê°€ ìˆëŠ” ê²½ìš° ì—¬ì „íˆ í›Œë¥­í•œ ì„ íƒì…ë‹ˆë‹¤. 

ref ì ‘ê·¼ì€ ì¿¼ë¦¬ì— **ì¸ë±ìŠ¤ê°€ ìˆëŠ” ì—´ì´ ë™ë“± ì—°ì‚°ìì— ì˜í•´ ì¼ì¹˜**ë  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. 

MySQLì´ ì¸ë±ìŠ¤ë¥¼ ë°”íƒ•ìœ¼ë¡œ í•„ìš”í•œ í–‰ì„ ì°¾ì„ ìˆ˜ ìˆë‹¤ë©´, í•˜ëŠ” ê²ƒì„ í”¼í•˜ê³  ì¿¼ë¦¬ ì†ë„ë¥¼ í¬ê²Œ ë†’ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

#### **Fulltext**

ì‹œê°„ë³µì¡ë„ : O(log N)

MySQLì€ í…ìŠ¤íŠ¸ ê¸°ë°˜ ê²€ìƒ‰ ì¿¼ë¦¬ë¥¼ ìœ„í•œ ì—´ì— Full-Text Indexë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” ì˜µì…˜ì„ ì œê³µí•©ë‹ˆë‹¤. 

`MATCH() ... AGAINST()`ê°™ì€ íŠ¹ë³„í•œ êµ¬ë¬¸ì— ì‚¬ìš©ë©ë‹ˆë‹¤. 

ì¿¼ë¦¬ì— Full-Text Indexë¥¼ ê°€ì§„ ì¹¼ëŸ¼ì´ í¬í•¨ë˜ê³  Full-Text Indexê°€ ìˆëŠ” ê²½ìš° fulltext ì ‘ê·¼ ë°©ì‹ì´ ì‚¬ìš©ë©ë‹ˆë‹¤. 

fulltext ì ‘ê·¼ì„ í†µí•´ MySQLì€ ì¸ë±ìŠ¤ë¥¼ ê²€ìƒ‰í•˜ê³  ê²°ê³¼ë¥¼ ë¹ ë¥´ê²Œ ë°˜í™˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. 

#### **Range**

ì‹œê°„ë³µì¡ë„ : O(log N)

where ì ˆì—ì„œ ë²”ìœ„ ì—°ì‚°ìë¥¼ ì‚¬ìš©í•  ë•Œ, MySQLì€ ì˜¬ë°”ë¥¸ ë°ì´í„°ë¥¼ ì°¾ê¸° ìœ„í•´ **ê°’ì˜ ë²”ìœ„ë¥¼ í†µí•´ ê²€ìƒ‰í•´ì•¼ í•œë‹¤**ëŠ” ê²ƒì„ ì•Œê³  ìˆìŠµë‹ˆë‹¤. (`BETWEEN`, `>`, `<`, `>=`, `<=`)

MySQLì€ B-Tree ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ íŠ¸ë¦¬ ìƒë‹¨ì—ì„œ ë²”ìœ„ì˜ ì²« ë²ˆì§¸ ê°’ê¹Œì§€ ë‚´ë ¤ê°‘ë‹ˆë‹¤. 

ê±°ê¸°ì„œë¶€í„° MySQLì€ íŠ¸ë¦¬ í•˜ë‹¨ì˜ ì—°ê²° ë¦¬ìŠ¤íŠ¸ë¥¼ ì°¸ì¡°í•˜ì—¬ ì›í•˜ëŠ” ë²”ìœ„ ë‚´ì˜ ê°’ì´ ìˆëŠ” í–‰ì„ ì°¾ìŠµë‹ˆë‹¤. 

MySQLì€ ë¶ˆì¼ì¹˜ê°€ ë°œê²¬ë  ë•Œê¹Œì§€ **ë²”ìœ„ ë‚´ì˜ ëª¨ë“  ìš”ì†Œë¥¼ ê²€í† í•œë‹¤**ëŠ” ì ì„ ì£¼ëª©í•œë‹¤ë©´, ì´ ë°©ë²•ì€ const, ref ë“± ë‹¤ë¥¸ ë°©ì‹ë“¤ë³´ë‹¨ ëŠë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

- const, range ëŠ” í•˜ë‚˜ë§Œ ì°¾ìœ¼ë©´ ë©ë‹ˆë‹¤.
- range ëŠ” ì‹œì‘ì ì„ ì°¾ì€ í›„ í•´ë‹¹ ë²”ìœ„ì— ì†í•˜ëŠ” ëª¨ë“  ë°ì´í„°ë¥¼ ìˆœì°¨ì ìœ¼ë¡œ ê²€ìƒ‰í•´ì„œ ë°˜í™˜í•´ì•¼ í•©ë‹ˆë‹¤. ê°€ì ¸ì™€ì•¼ í•˜ëŠ” ê°’ì´ ë§ìœ¼ë‹ˆê¹Œ ë‹¹ì—°í•˜ì£  ë­.ğŸ¤·

#### **Index**

ì‹œê°„ë³µì¡ë„ : O(N) `ìµœì í™” í•„ìš”`

ì¸ë±ìŠ¤ ì ‘ê·¼ ë°©ì‹ì€ MySQLì´ í•„ìš”í•œ ë°ì´í„°ë¥¼ ì°¾ê¸° ìœ„í•´ ëª¨ë“  ì¸ë±ìŠ¤ë¥¼ ìŠ¤ìº”í•œë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ëƒ…ë‹ˆë‹¤. 

ì¸ë±ìŠ¤ ì ‘ê·¼ì€ ì§€ê¸ˆê¹Œì§€ ë‚˜ì—´ëœ ì ‘ê·¼ ë°©ì‹ ì¤‘ ê°€ì¥ ëŠë¦¬ì§€ë§Œ, Full Table Scaní•˜ëŠ” ê²ƒë³´ë‹¤ëŠ” ì—¬ì „íˆ ë¹ ë¦…ë‹ˆë‹¤. 

- MySQLì´ ê¸°ë³¸(primary) ë˜ëŠ” ê³ ìœ (unique) ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•  ìˆ˜ ì—†ì„ ë•Œ, ì¸ë±ìŠ¤ê°€ ìˆë‹¤ë©´ ì¸ë±ìŠ¤ ì ‘ê·¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤.
    - MySQL ì˜µí‹°ë§ˆì´ì €ê°€ â€œì´ ì¿¼ë¦¬ëŠ” ì¸ë±ìŠ¤ ì „ì²´ ìŠ¤ìº”ì„ ì‹¤í–‰í•˜ëŠ” ê²ƒì´ ì„±ëŠ¥ì— ë‚«ê² ëŠ”ë°?â€ë¼ê³  íŒë‹¨í•˜ë©´ ì¸ë±ìŠ¤ ì ‘ê·¼ì„ ì‚¬ìš©í•©ë‹ˆë‹¤. (ì¿¼ë¦¬ê°€ ì¸ë±ìŠ¤ì— í¬í•¨ëœ ëª¨ë“  ì»¬ëŸ¼ì„ ì‚¬ìš©í•˜ê±°ë‚˜, ì¸ë±ìŠ¤ê°€ ì¿¼ë¦¬ ì¡°ê±´ì— ì˜ ë§ì„ ë•Œ)
    

#### **All**

ì‹œê°„ë³µì¡ë„ : O(N) `ìµœì í™” í•„ìš”`

ë§ˆì§€ë§‰ìœ¼ë¡œ, all ì ‘ê·¼ ë°©ì‹ì€ MySQLì´ í•„ìš”í•œ ë°ì´í„°ë¥¼ ì°¾ê¸° ìœ„í•´ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°ë¥¼ ë‹¤ ë’¤ì ¸ë³¸ë‹¤ëŠ” ê²ƒì„ ì˜ë¯¸í•©ë‹ˆë‹¤. 

allì€ **ê°€ì¥ ëŠë¦¬ê³  ë¹„íš¨ìœ¨ì **ì¸ ì ‘ê·¼ ë°©ì‹ì´ë¯€ë¡œ, ê°€ëŠ¥í•œ í•œ í”¼í•˜ê³ ì í•˜ëŠ” ë°©ì‹ì…ë‹ˆë‹¤. 

ì ì ˆí•œ ì¸ë±ìŠ¤ê°€ ì—†ì„ ë•Œ MySQLì€ ì „ì²´ í…Œì´ë¸”ì„ ìŠ¤ìº”í•  ìˆ˜ë„ ìˆìœ¼ë¯€ë¡œ, ì´ëŠ” ì¸ë±ì‹± ì „ëµì„ ê²€ì‚¬í•  ì¢‹ì€ ê¸°íšŒì…ë‹ˆë‹¤.

### **Explainì˜ ì¶œë ¥ í˜•ì‹ ì œì–´í•˜ê¸°**

#### **FORMAT = TREE**

íŠ¸ë¦¬ í˜•ì‹ì€ ì‹¤í–‰ ê³„íšì„ ì¤‘ì²©ëœ íŠ¸ë¦¬ êµ¬ì¡°ë¡œ ìì„¸íˆ ì œê³µí•˜ëŠ” ë° ìœ ìš©í•©ë‹ˆë‹¤.

```sql
explain format=tree select * from people where first_name = "Aaron"
```

#### **FORMAT = JSON**

JSON í˜•ì‹ì„ ì‚¬ìš©í•˜ë©´ `ì¿¼ë¦¬ì˜ ì¸ë±ìŠ¤ ì‚¬ìš©, key parts, ì¿¼ë¦¬ ë¹„ìš©`ì— ëŒ€í•œ ì •ë³´ë¥¼ ê¸°ê³„ê°€ ì½ì„ ìˆ˜ ìˆëŠ” JSON í˜•ì‹ìœ¼ë¡œ ì œê³µí•©ë‹ˆë‹¤.

```sql
explain format=json select * from people where first_name = "Aaron"
```

#### **EXPLAIN ANALYZE**

```sql
EXPLAIN ANALYZE format=json select * from people where first_name = "Aaron"
```

EXPLAIN ANALYZEëŠ” ì‹¤ì œë¡œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ê³  ì¿¼ë¦¬ ì‹¤í–‰ ê³„íšì— ëŒ€í•œ ìì„¸í•œ í†µê³„ë¥¼ ì œê³µí•©ë‹ˆë‹¤. ì´ í˜•ì‹ì€ **ì‹¤ì œë¡œ ì¿¼ë¦¬ë¥¼ ì‹¤í–‰í•˜ë¯€ë¡œ** ì£¼ì˜í•´ì„œ ì‚¬ìš©í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ìœ ì˜í•´ì•¼ í•©ë‹ˆë‹¤.

EXPLAIN ANALYZE í˜•ì‹ì„ ì‚¬ìš©í•˜ë©´, MySQLì€ `ì‹¤ì œ ì‹¤í–‰ ì‹œê°„`ê³¼ `ì½ì€ ë ˆì½”ë“œ ìˆ˜`ë¥¼ í¬í•¨í•œ **ìì„¸í•œ í†µê³„ë¥¼ ì œê³µ**í•©ë‹ˆë‹¤. 

**ì¡°ì¸ì´ë‚˜ ì„œë¸Œì¿¼ë¦¬**ê°€ í¬í•¨ëœ ì¿¼ë¦¬ë¥¼ ì‘ì—…í•˜ëŠ” ê²½ìš°, ì´ í†µê³„ëŠ” ì¿¼ë¦¬ê°€ ì‹œê°„ì„ ì–´ë””ì— ì“°ê³  ìˆëŠ”ì§€ ì´í•´í•˜ëŠ” ë° ë§¤ìš° ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.

## ğŸ¬ **ì‹¤ì „ ì¿¼ë¦¬ íŠœë‹**

### **ì¸ë±ìŠ¤ ë‚œë…(Index obfuscation) ë°©ì§€**

ì¸ë±ìŠ¤ ë‚œë…(**Index obfuscation**)ì„ ë°©ì§€í•˜ë ¤ë©´ ê°€ëŠ¥í•œ ì—´(column)ì„ ê·¸ëŒ€ë¡œ ë‘ì–´ì•¼ í•©ë‹ˆë‹¤.

íš¨ìœ¨ì ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì§ˆì˜í•˜ë ¤ë©´, ì¿¼ë¦¬ë¬¸ì„ ì§¤ ë•Œ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê²Œë” ì§œëŠ”ê²Œ ì¢‹ìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ 

ì˜ˆë¥¼ ë“¤ë©´, Movie í…Œì´ë¸”ì—ì„œ 2ì‹œê°„ ë¯¸ë§Œì˜ ì˜í™”ë¥¼ í•„í„°ë§í•˜ê³  ì‹¶ë‹¤ê³  í•´ë´…ì‹œë‹¤.

Movie í…Œì´ë¸”ì˜ **ìƒì˜ì‹œê°„** ì¹¼ëŸ¼ì€ ë¶„ ë‹¨ìœ„ë¡œ ë˜ì–´ ìˆìœ¼ë¯€ë¡œ ìƒì˜ì‹œê°„ì„ 60ìœ¼ë¡œ ë‚˜ëˆ„ì–´ ì‹œê°„ìœ¼ë¡œ ë³€í™˜í•´ì•¼ í•©ë‹ˆë‹¤. 

ê·¸ëŸ¬ë‚˜ ì´ë ‡ê²Œ ì¹¼ëŸ¼ì„ ì§ì ‘ ê°€ê³µí•˜ëŠ” ì—°ì‚°ì„ í•˜ë©´ ì—´ì„ í˜¼ë€í•˜ê²Œ ë§Œë“¤ê³  MySQLì´ ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸° ì–´ë µê²Œ ë§Œë“­ë‹ˆë‹¤. ì¸ë±ìŠ¤ë¥¼ í™œìš©í•˜ì§€ ëª»í•˜ê³  Full Table Scanì„ í•´ì•¼ ë˜ëŠ”ê±°ì£ .

ì¸ë±ìŠ¤ ì—´ì„ ì§ì ‘ ê°€ê³µí•˜ëŠ” ëŒ€ì‹ , **ìµœëŒ€í•œ ë‹¤ë¥¸ í•­ìœ¼ë¡œ ìš”ì†Œë“¤ì„ ì˜®ê¸°ì„¸ìš”.**

```sql
SELECT * FROM film WHERE length / 60 < 2;
```

> ì´ ì‹ì—ì„œëŠ” **`length`** ì—´ì˜ ê° ê°’ì— ëŒ€í•´ 60ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê³„ì‚°ì„ í•©ë‹ˆë‹¤. ê·¸ëŸ° ë‹¤ìŒ ê·¸ ê²°ê³¼ê°€ 2ë³´ë‹¤ ì‘ì€ì§€ í™•ì¸í•©ë‹ˆë‹¤. 
> 
> ì´ ë°©ì‹ì˜ ë¬¸ì œëŠ”, ë°ì´í„°ë² ì´ìŠ¤ê°€ ì´ë¯¸ ë§Œë“¤ì–´ë‘” ì¸ë±ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ì—†ê²Œ ëœë‹¤ëŠ” ê²ƒì…ë‹ˆë‹¤. 
> 
> ì™œëƒí•˜ë©´ ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì›ë˜ì˜ **`length`** ê°’ì´ ì•„ë‹Œ ê³„ì‚°ëœ ê²°ê³¼ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¹„êµë¥¼ í•´ì•¼ í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. 
> 
> ì´ë¡œ ì¸í•´, ë°ì´í„°ë² ì´ìŠ¤ëŠ” í…Œì´ë¸”ì˜ ëª¨ë“  í–‰ì„ í•˜ë‚˜í•˜ë‚˜ ê²€ì‚¬í•´ì•¼ í•˜ë©°, ì´ëŠ” ë§¤ìš° ë¹„íš¨ìœ¨ì ì…ë‹ˆë‹¤.

```sql
SELECT * FROM film WHERE length < 2 * 60;
```

> ë°˜ë©´ì— ì´ ì‹ì—ì„œëŠ” **`length`** ì—´ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ê³ , ë¹„êµí•˜ëŠ” ê°’(2ì‹œê°„)ì„ ë¶„ ë‹¨ìœ„ë¡œ ë³€í™˜í•˜ì—¬ (**`2 * 60`**, ì¦‰ 120ë¶„) ë¹„êµí•©ë‹ˆë‹¤. 
> 
> ì´ ë°©ë²•ì€ ë°ì´í„°ë² ì´ìŠ¤ê°€ **`length`** ì—´ì— ëŒ€í•´ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ ì¸ë±ìŠ¤ë¥¼ í™œìš©í•  ìˆ˜ ìˆê²Œ í•´ì¤ë‹ˆë‹¤. 
> 
> ë°ì´í„°ë² ì´ìŠ¤ëŠ” ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•˜ì—¬ í•„ìš”í•œ í–‰ë“¤ì„ í›¨ì”¬ ë¹ ë¥´ê³  íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.


### **ì¤‘ë³µ ì¡°ê±´(rebundant condition)**

ì¤‘ë³µ ì¡°ê±´ì´ë€, ì¿¼ë¦¬ì— ì ì–´ë„ ë…¼ë¦¬ì ìœ¼ë¡œ ê²°ê³¼ë¥¼ ë³€ê²½í•˜ì§€ ì•ŠëŠ” ë‘ ë²ˆì§¸ ì¡°ê±´ì„ ë§í•©ë‹ˆë‹¤.Â 

ê²°ê³¼ì— ì•„ë¬´ëŸ° ë³€í™”ê°€ ì—†ì§€ë§Œ ì¿¼ë¦¬ë¥¼ ìµœì í™”í•˜ëŠ” ë° ë„ì›€ì´ ë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì— ì—¬ì „íˆ ê°€ì¹˜ê°€ ìˆìŠµë‹ˆë‹¤.Â 

í˜„ì‹¤ì ìœ¼ë¡œ ìš°ë¦¬ëŠ” DB í…Œì´ë¸” êµ¬ì¡°ë¥¼ ë°”ê¿€ìˆœ ì—†ìŠµë‹ˆë‹¤. 

í•˜ì§€ë§Œ ì¤‘ë³µì¡°ê±´ì„ ì‚¬ìš©í•˜ë©´ **í…Œì´ë¸” êµ¬ì¡°ë¥¼ ë³€ê²½í•˜ì§€ ì•Šê³ ** ì¸ë±ìŠ¤ë¥¼ íš¨ê³¼ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤ëŠ” ì¥ì ì´ ìˆìŠµë‹ˆë‹¤. 



ìš°ë¦¬ì˜ Todo-list í…Œì´ë¸”ì—ì„œ due_timeì´ 24ì‹œê°„ ì´ë‚´ë¡œ ë‚¨ì€ ë ˆì½”ë“œë¥¼ ê°€ì ¸ì˜¤ê³  ì‹¶ë‹¤ê³  ìƒìƒí•´ë´…ì‹œë‹¤.

due_date ì—ëŠ” ì¸ë±ìŠ¤ê°€ ìˆì§€ë§Œ, ADDTIME(due_date + due_time) ì—°ì‚°ì„ í•´ë²„ë¦¬ë©´ ì¸ë±ìŠ¤ê°€ obfuscatedë˜ì–´ë²„ë ¤ì„œ full-table-scan ì„ í•´ì•¼í•©ë‹ˆë‹¤.

| id  | task       | due_time | due_date   | completed |
| --- | ---------- | -------- | ---------- | --------- |
| 1   | ê³µë¶€í•˜ê¸°   | 18:00:00 | 2023-12-29 | false     |
| 2   | ë¿Œë§í´ë¨¹ê¸° | 15:30:00 | 2023-12-30 | false     |
| 3   | ë†€ê¸°       | 23:59:59 | 2023-12-28 | false     |

##### Before Tunning

```sql
SELECT * FROM todos
WHERE
ADDTIME(due_date, due_time) BETWEEN NOW() AND NOW() + INTERVAL 1 DAY
```

ì´ëŸ° ê²½ìš°ì— ì¤‘ë³µì¡°ê±´ì„ ì‚¬ìš©í•˜ë©´ ìœ ë¦¬í•©ë‹ˆë‹¤. 

ì¸ë±ìŠ¤ë¥¼ ì‚¬ìš©í•œ ì¤‘ë³µ ì¡°ê±´ìœ¼ë¡œ íƒìƒ‰ ë²”ìœ„ë¥¼ ë¨¼ì € ì¤„ì—¬ë†“ëŠ” ê²ë‹ˆë‹¤.

ì „ì²´ í…Œì´ë¸”ì—ì„œ **ê²°ê³¼ë³´ë‹¤ ì‚´ì§ í° ë²”ìœ„**ê¹Œì§€ ëŒ€ì¶© ì˜ë¼ì¤ë‹ˆë‹¤. (ë©‹ìˆëŠ” ë§ë¡œ **ê·¼ì‚¬ì¹˜**approximate ë¼ê³  ë¶€ë¦…ë‹ˆë‹¤.)

ê·¸ ì•ˆì—ì„œ ì¡°ê±´ì— ë¶€í•©í•˜ì§€ ì•ŠëŠ” ê²ƒì„ í•„í„°ë§í•˜ë©´ ë©ë‹ˆë‹¤.

ì¸ë±ìŠ¤ê°€ ì—†ëŠ” í•„í„°ë§ì€ êµ‰ì¥íˆ ë¹„ì‹¼ë°, ì´ë ‡ê²Œ íƒìƒ‰ë²”ìœ„ë¥¼ í™• ì¤„ì—¬ì„œ ë¹„ìš©ì„ ì•„ë‚„ ìˆ˜ ìˆì£ .

##### After Tunning

```sql
SELECT * FROM todos
WHERE
ADDTIME(due_date, due_time) BETWEEN NOW() AND NOW() + INTERVAL 1 DAY
AND
due_date BETWEEN CURRENT_DATE AND CURRENT_DATE + INTERVAL 1 DAY
```

### **í•„ìš”í•œ ë§Œí¼ë§Œ ë°˜í™˜ë°›ê¸°(select only what you need)**

ë°ì´í„°ë² ì´ìŠ¤ í…Œì´ë¸”ì—ì„œ `SELECT *`ë¬¸ì„ ì‹¤í–‰í•˜ë©´ í…Œì´ë¸”ì˜ ëª¨ë“  ë°ì´í„°, ëª¨ë“  í–‰ê³¼ ì—´ì„ ê²€ìƒ‰í•©ë‹ˆë‹¤. 

JSONì´ë‚˜ TEXTì™€ ê°™ì€ ìš©ëŸ‰ì´ í° ì—´ì„ ë‹¤ë£° ë•Œ í…Œì´ë¸” ë‚´ ëª¨ë“  ë°ì´í„°ë¥¼ ê²€ìƒ‰í•˜ëŠ” ê²ƒì€ ìƒë‹¹í•œ ì„±ëŠ¥ ë¬¸ì œë¥¼ ì•¼ê¸°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

ì‹¤ì œë¡œ ì‚¬ìš©í•  ê³„íšì´ ìˆëŠ” ì—´ë§Œ ê²€ìƒ‰í•œë‹¤ë©´ ë„¤íŠ¸ì›Œí¬ ì‚¬ìš©ë¥ , ë””ìŠ¤í¬ ì•¡ì„¸ìŠ¤ ë° ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ì´ í¬ê²Œ ì¤„ì–´ë“­ë‹ˆë‹¤.

> íŠ¹íˆ ì¿¼ë¦¬ë¬¸ ì‘ì„± ì‹œ ì¸ë±ìŠ¤ê°€ ìˆëŠ” ì—´ì„ ê¸°ì¤€ìœ¼ë¡œ í•œë‹¤ë©´ ë¹ ë¥´ê²Œ í•„ìš”í•œ í–‰ë§Œ ê°€ì ¸ì˜¤ê²Œë” ë²”ìœ„ë¥¼ ì¢í ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. í…Œì´ë¸”ì˜ í–‰ ìˆ˜ ì„¸ê¸°
    
    ```sql
    SELECT COUNT(*) FROM table_name;
    ```
    
    í…Œì´ë¸”ì˜ í–‰ ìˆ˜ë¥¼ ì„¸ê³  ì‹¶ë‹¤ë©´ ëª¨ë“  ë°ì´í„°ë¥¼ ì„ íƒí•˜ì—¬ ì• í”Œë¦¬ì¼€ì´ì…˜ìœ¼ë¡œ ë³´ë‚´ì§€ ë§ì•„ì•¼ í•©ë‹ˆë‹¤. ëŒ€ì‹  ì´ ì‘ì—…ì„ ë°ì´í„°ë² ì´ìŠ¤ì— ìœ„ì„í•˜ì—¬ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ê³„ì‚°í•˜ê²Œ í•´ì•¼ í•©ë‹ˆë‹¤.
    
2. ì—°ì‚°í•˜ê¸°
    
    ```sql
    SELECT MIN(column_name) FROM table_name;
    
    SELECT MAX(column_name) FROM table_name;
    
    SELECT AVG(column_name) FROM table_name;
    ```
    
    ìµœì†Œê°’, ìµœëŒ€ê°’ ë° í‰ê· ê°’ê³¼ ê°™ì€ ê³„ì‚°ì€ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œê°€ ì•„ë‹Œ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìˆ˜í–‰í•´ì•¼ í•©ë‹ˆë‹¤. 
    
    ì´ëŸ¬í•œ ê³„ì‚°ì„ ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ìˆ˜í–‰í•¨ìœ¼ë¡œì¨ ë„¤íŠ¸ì›Œí¬ë¡œ ë³´ë‚´ëŠ” ë°ì´í„° ë¹„ìš©ì„ í¬ê²Œ ì¤„ì¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. 
    
    ë˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ëª¨ë“  í–‰ì„ ì‚´í´ë³´ê³  ì‚¬ìš©ìì—ê²Œ ë‹¤ì‹œ ë³´ë‚´ëŠ” ë¶ˆí•„ìš”í•œ ê³¼ì •ì„ ì—†ì•¨ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
3. ì¤‘ë³µëœ ê°’ì€ ë°›ì§€ ì•Šê¸°
    
    ```sql
    SELECT DISTINCT column_name FROM table_name;
    ```
    
    DBì—ì„œ DISTINCT ë¡œ ì¤‘ë³µì œê±° ì‘ì—…ì„ ìˆ˜í–‰í•œë‹¤ë©´ ì• í”Œë¦¬ì¼€ì´ì…˜ì—ê²Œ ë¶ˆí•„ìš”í•œ í–‰ì„ ë³´ë‚´ì§€ ì•Šì•„ë„ ë©ë‹ˆë‹¤. 
    

### **í–‰ ì œí•œí•˜ê¸°(Limiting rows)**
ì¿¼ë¦¬ì—ì„œ ë°˜í™˜ë˜ëŠ” í–‰ì˜ ìˆ˜ë¥¼ ì œí•œí•˜ì„¸ìš”.

**ì£¼ì˜!** ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ë°›ì•„ì„œ ë°ì´í„°ë¥¼ í•„í„°ë§í•˜ëŠ”ê²Œ ì•„ë‹ˆë¼, DB ë‹¨ê³„ì—ì„œ ë°˜í™˜í•  í–‰ì˜ ê°¯ìˆ˜ë¥¼ ê³„ì‚°í•´ì„œ ë³´ë‚´ê²Œ í•´ì•¼í•©ë‹ˆë‹¤.

#### **í˜ì´ì§€ë„¤ì´ì…˜ ì¿¼ë¦¬ ì‚¬ìš©í•˜ê¸°**

```sql
LIMIT 10 OFFSET 20
```

`LIMIT`ì— `ORDER BY` ì ˆì„ í•­ìƒ ë„£ì–´ì•¼ í•˜ë©°, ê·¸ê²ƒì´ ë‹¨ìˆœíˆ `ORDER BY id`ë¼ í•˜ë”ë¼ë„ ë§ˆì°¬ê°€ì§€ì…ë‹ˆë‹¤. 

ê·¸ë ‡ì§€ ì•Šìœ¼ë©´ MySQLì´ í–‰ì„ ì •ë ¬í•˜ëŠ” ë°©ë²•ì„ ê²°ì •í•˜ê²Œ ë˜ë©°, ì´ëŠ” ì¼ê´€ì„±ì— ë¬¸ì œë¥¼ ì¼ìœ¼í‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤. (ì˜ˆ -ì‚¬ìš©ìëŠ” ë˜‘ê°™ì´ ê²Œì‹œíŒì˜ 2ë²ˆ í˜ì´ì§€ë¥¼ í´ë¦­í–ˆëŠ”ë°, ìƒˆë¡œê³ ì¹¨í• ë•Œë§ˆë‹¤ ì™„ì „ ë‹¤ë¥¸ ê²Œì‹œë¬¼ë“¤ì´ 2ë²ˆ í˜ì´ì§€ì— ìˆìŒ.)

#### **í˜ì´ì§€ë„¤ì´ì…˜ì´ë€?**

> í˜ì´ì§€ë„¤ì´ì…˜ì€ ì‚¬ìš©ìê°€ ê´€ì‹¬ ìˆì–´ í•  íŠ¹ì • í˜ì´ì§€ì˜ ê²°ê³¼ë§Œ ë°˜í™˜í•˜ëŠ” ê¸°ìˆ ì„ ë§í•©ë‹ˆë‹¤. 
> 
> ì˜ˆë¥¼ ë“¤ì–´, ì‚¬ìš©ìê°€ get ìš”ì²­í–ˆì„ë•Œ ì•±ì€ 500,000ê°œì˜ ì¸ìŠ¤íƒ€ê·¸ë¨ ê²Œì‹œë¬¼ì„ ë°˜í™˜í•œë‹¤ë©´ ë§¤ìš°  ë§ì€ ì²˜ë¦¬ë¥¼ ë‚­ë¹„í•˜ê²Œ ë©ë‹ˆë‹¤.
> 
> ì™œëƒë©´ ì„±ëŠ¥ê³¼ ì‚¬ìš©ì„±ì„ ìœ„í•´ ì‚¬ìš©ìì˜ í™”ë©´ì—ëŠ” ê²Œì‹œë¬¼ì„ 10ê°œì”©ë§Œ ë³´ì—¬ì£¼ëŠ” ê²½ìš°ê°€ ëŒ€ë¶€ë¶„ì´ê±°ë“ ìš”. 
> 
> ë”°ë¼ì„œ `LIMIT`, `OFFSET`ë“±ì„ ì´ìš©í•´ ë°˜í™˜í•˜ëŠ” í–‰ì˜ ìˆ˜ë¥¼ ì œí•œí•˜ê³  ì‚¬ìš©ìì—ê²Œ ìœ ìš©í•  ë§Œí¼ì˜ í–‰ë§Œ ë°˜í™˜í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.


## ğŸ“Â **Related articles**

| ì´ìŠˆëª…                      | ë§í¬                                                                                                                                                                                     |
| --------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| Introduction to queries     | [https://planetscale.com/learn/courses/mysql-for-developers/queries/introduction-to-queries](https://planetscale.com/learn/courses/mysql-for-developers/queries/introduction-to-queries) |
| ì„±ëŠ¥ í–¥ìƒì„ ìœ„í•œ SQL ì‘ì„±ë²• | [https://d2.naver.com/helloworld/1155](https://d2.naver.com/helloworld/1155)                                                                                                             |
